<?xml version="1.0" encoding="UTF-8"?>
<!-- <!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd"> -->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">


	<!-- Istanza task SPLITTER-->
	<bean id="tcdSplitter" class="it.micronixnetwork.tcd.engine.Splitter" init-method="loadConfig" >

		<property name="fileService" ref="fileSystemService" />
		<property name="configService" ref="tcdConfigService" />
		<property name="engineService" ref="tcdEngineService" />

		<property name="userService" ref="userService" />
		<property name="logService" ref="tcdLogService" />

		<property name="notifySmtpHost" value="localhost" />
		<!--
		<property name="notifySmtpUser" value="username" />
		<property name="notifySmtpPassword" value="password" />
		-->
		<property name="notifyFrom" value="tcd@micronixnetwork.it" />
		<property name="notifyCC" value="tcdAdmin@micronixnetwork.it" />

		<property name="rootPath" value="/var/micronix/tcdRoot/" />

	</bean>

	<!-- Schedulazione SPLITTER -->
	<bean id="tcdRunSplitter" class="org.springframework.scheduling.timer.ScheduledTimerTask">
		<property name="delay" value="5000" />
		<property name="period" value="10000" />
		<property name="timerTask" ref="tcdSplitter" />
	</bean>

	<!-- Istanza task COMPOSER -->
	<bean id="tcdComposer" class="it.micronixnetwork.tcd.engine.Composer" init-method="loadConfig" >

		<property name="engineService" ref="tcdEngineService" />
		<property name="logService" ref="tcdLogService" />
		<property name="userService" ref="userService" />
		<property name="modelService" ref="tcdModelService" />
		<property name="configService" ref="tcdConfigService" />

		<!-- parametri di default globali -->
		<property name="emailDefaultSender" value="email@micronixnetwork.it" />

		<property name="printHost" value="localhost" />

		<property name="arcRoot" value="/var/micronix/TCDARC/" />

	    <property name="faxDefaultSender" value="fax@micronixnetwork.it" />


	    <property name="notifySmtpHost" value="localhost" />
		<!--
		<property name="notifySmtpUser" value="username" />
		<property name="notifySmtpPassword" value="password" />
		-->
		<property name="notifyFrom" value="tcd@micronixnetwork.it" />
		<property name="notifyCC" value="tcdAdmin@micronixnetwork.it" />

	</bean>

	<!-- Schedulazione COMPOSER -->
	<bean id="tcdRunComposer" class="org.springframework.scheduling.timer.ScheduledTimerTask">
		<property name="delay" value="7500" />
		<property name="period" value="10000" />
		<property name="timerTask" ref="tcdComposer" />
	</bean>


	<!-- Istanza task ROUTER (SENDER) -->
	<bean id="tcdRouter" class="it.micronixnetwork.tcd.engine.Router" init-method="loadConfig" >

		<property name="engineService" ref="tcdEngineService" />
		<property name="fileService" ref="fileSystemService" />
		<property name="userService" ref="userService" />
		<property name="configService" ref="tcdConfigService" />
		<property name="logService" ref="tcdLogService" />

		<!-- intervallo del processo per la coda dei routers in errore
			 il tempo tra un tentativo e l'altro è dato dal prodotto di questo valore
			 per il valore period/1000 della configurazione di "tcdRunRouter"
		-->
		<property name="retryCountInterval" value="3" />

		<!-- intervallo del processo per la coda dei lavori "ritardati" es. fax
			 il tempo tra una verifica stato e l'altra è dato dal prodotto di questo valore
			 per il valore period/1000 della configurazione di "tcdRunRouter"

		<property name="chkCountInterval" value="50" />
		-->

		<property name="arcRetryCount" value="2" />

		<property name="printRetryCount" value="3" />


	<!-- parametri server SMTP (email) -->
		<property name="emailRetryCount" value="5" />

		<property name="emailSmtpHost" value="192.168.69.1" />
		<!--
		<property name="emailSmtpUser" value="username" />
		<property name="emailSmtpPassword" value="password" />
		-->


	<!-- Parametri FAX -->
		<property name="faxRetryCount" value="3" />

		<property name="faxSmtpHost" value="localhost" />
		<property name="faxSmtpPort" value="26" />
		<!--
		<property name="faxSmtpUser" value="username" />
		<property name="faxSmtpPassword" value="password" />
		-->
		<property name="faxDomain" value="fendi.fax" />

		<property name="faxStatusHost" value="localhost" />
		<property name="faxStatusPort" value="25" />

		<property name="faxStatusUser" value="username" />
		<property name="faxStatusPassword" value="password" />

		<property name="faxStatusPassive" value="false" />
		<property name="faxStatusDomain" value="fendi.fax" />

	</bean>

	<!-- Schedulazione ROUTER -->
	<bean id="tcdRunRouter" class="org.springframework.scheduling.timer.ScheduledTimerTask">
		<property name="delay" value="5000" />
		<property name="period" value="20000" />
		<property name="timerTask" ref="tcdRouter" />
	</bean>


	<!-- Factory Timer schedulati -->
	<bean id="timerFactory" class="org.springframework.scheduling.timer.TimerFactoryBean">
		<property name="scheduledTimerTasks">
			<list>
				<!--ref bean="tcdRunSplitter" />
				<ref bean="tcdRunComposer" />
				<ref bean="tcdRunRouter" /-->
			</list>
		</property>
	</bean>



<!--  TEST  -->

	<bean id="destinatriTest" class="it.micronixnetwork.tcd.test.DestinatariTest">
	  <property name="description" value="Test sul recupero dei destinari" />
	  <property name="carrierService" ref="tcdCarrierService" />
	  <property name="engineService" ref="tcdEngineService" />
	  <property name="logService" ref="tcdLogService" />
	  <property name="userService" ref="userService" />
	</bean>


 <!-- Task di test per i servizi -->
	 <bean id="testTask" class="it.micronixnetwork.gaf.service.task.TestTask">
	 <property name="detail" value="true" />
	 <property name="runners">
	     <list>
	         <ref bean="destinatriTest"/>
	     </list>
	     </property>

	 </bean>

 <!-- Schedulazione TEST -->
	 <bean id="testRun" class="org.springframework.scheduling.timer.ScheduledTimerTask">
	  <property name="delay" value="0" />
	  <property name="period" value="0" />
	  <property name="timerTask" ref="testTask" />
	 </bean>



	<bean id="tcdConfigService" class="it.micronixnetwork.tcd.service.ConfigServiceImpl">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>

	<bean id="tcdEngineService" class="it.micronixnetwork.tcd.service.EngineServiceImpl">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>

	<bean id="tcdCarrierService" class="it.micronixnetwork.tcd.service.CarrierServiceImpl">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>

	<bean id="tcdLogService" class="it.micronixnetwork.tcd.service.LogServiceImpl">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>

	<bean id="tcdModelService" class="it.micronixnetwork.tcd.service.ModelServiceImpl">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>

</beans>
